<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Kino & Shorts MiniApp</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        body {
            background: linear-gradient(135deg, #131927, #2082c6 60%);
            color: #edf2fa;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
        }
        .header {
            background: #0a143a;
            padding: 1.5rem;
            text-align: center;
            font-weight: bold;
            font-size: 2rem;
            margin-bottom: 20px;
        }
        .tabs {
            text-align: center;
            margin-bottom: 20px;
        }
        .tab-btn {
            background: #192c47;
            color: #b9d6f9;
            border: none;
            border-radius: .5rem .5rem 0 0;
            margin: 0 7px;
            padding: 10px 24px;
            cursor: pointer;
            font-size: 1rem;
            outline:none;
        }
        .tab-btn.active {
            background: #2082c6;
            color: #fff;
            font-weight: bold;
        }
        .container {
            max-width: 600px;
            margin: 0 auto 2rem;
        }
        .card {
            background: #21284a;
            margin-bottom: 1.3rem;
            padding: 1.2rem;
            border-radius: 1rem;
            box-shadow: 0 2px 8px rgba(33,40,74,0.16);
        }
        .card-title {
            color: #18a0f2;
            font-size: 1.2rem;
            margin-bottom: .4rem;
        }
        .card-video { width: 100%; border-radius: .8rem; margin-bottom: .7rem; max-height:300px; background:#000;}
        .stats { color: #a3bdd7; font-size: .95rem; margin-bottom:.5rem;}
        .likebar {
            display:inline-flex;
            gap:10px;
            align-items:center;
            margin-bottom: 10px;
        }
        .likebtn, .dislikebtn {
            border:none;
            border-radius:6px;
            padding:4px 10px;
            font-size:1.2em;
            background:#182040;
            color:#77dbff;
            cursor:pointer;
            transition:.22s;
        }
        .likebtn.liked, .dislikebtn.liked {background:#18a0f2;color:#fff;}
        .upload-btn {
            display: block;
            background: linear-gradient(90deg,#1479c9,#1ec0ff 100%);
            color: #fff;
            font-weight: bold;
            border: none;
            border-radius: .7rem;
            margin:24px auto 24px;
            padding: 16px 32px;
            font-size: 1.1rem;
            cursor: pointer;
            box-shadow:0 2px 8px #1ec0ff44;
        }
        .upldform { max-width:400px; margin:0 auto 2rem; padding:20px; background:#26335b; border-radius:12px;}
        .upldform input, .upldform textarea {
            width:96%;margin-bottom:14px;
            padding:8px;
            border:none;border-radius:7px;font-size:1em;
        }
        .upldform label{font-size:.99em;}
        .mode-switcher {
            position: fixed; top: 10px; right: 10px;
            background: #1a233a; color: #b9d6f9;
            border: none; border-radius: .5rem; padding: .6rem 1.2rem;
            cursor: pointer; font-size: 1rem;
            box-shadow: 0 2px 8px rgba(33,40,74,0.15);
        }
        @media (max-width: 700px) {
            .container {max-width:100vw;}
            .card {padding:.7rem;}
            .upldform {padding:12px;}
        }
    </style>
</head>
<body>
    <div class="header">Kino & Shorts MiniApp</div>
    <button class="mode-switcher" onclick="toggleMode()">Dark Blue / Dark</button>
    <div class="tabs">
        <button class="tab-btn active" id="tab-cinema" onclick="showTab('cinema')">Kino</button>
        <button class="tab-btn" id="tab-shorts" onclick="showTab('shorts')">Shorts</button>
        <button class="tab-btn" id="tab-upload" onclick="showTab('upload')">Video yuklash</button>
        <button class="tab-btn" id="tab-top" onclick="showTab('top')">TOP ko‚Äòrilganlar</button>
    </div>
    <div class="container" id="content"></div>

    <script>
        // Demo uchun local data
        let videos = {
            "cinema": [
                {id:1, title:"O'zbek filmi", url:"https://samplelib.com/mp4/sample-5s.mp4", views:120, likes:17, dislikes:2},
                {id:2, title:"Komediya", url:"https://samplelib.com/mp4/sample-10s.mp4", views:88, likes:9, dislikes:1}
            ],
            "shorts": [
                {id:3, title:"Qiziqarli short", url:"https://samplelib.com/mp4/sample-3s.mp4", views:44, likes:7, dislikes:0}
            ]
        };

        const getLikeStatus = (type, id) => localStorage.getItem(`like_${type}_${id}`) || "";
        const setLikeStatus = (type, id, val) => localStorage.setItem(`like_${type}_${id}`, val);

        let darkBlue = true;
        function toggleMode() {
            if (darkBlue) {
                document.body.style.background = "#000001";
                document.querySelector('.header').style.background = "#101010";
                darkBlue = false;
            } else {
                document.body.style.background = "linear-gradient(135deg, #131927, #2082c6 60%)";
                document.querySelector('.header').style.background = "#0a143a";
                darkBlue = true;
            }
        }

        function showTab(tab) {
            document.querySelectorAll('.tab-btn').forEach(el=>el.classList.remove('active'));
            document.getElementById('tab-'+tab).classList.add('active');
            if(tab==='cinema') renderList('cinema');
            if(tab==='shorts') renderList('shorts');
            if(tab==='upload') renderUpload();
            if(tab==='top') renderTop();
        }

        function renderList(type){
            let html = `<button class="upload-btn" onclick="showTab('upload')">+ Video yuklash</button>`;
            videos[type].forEach(v=>{
                html += `
                  <div class="card">
                    <div class="card-title">${v.title}</div>
                    <video class="card-video" controls src="${v.url}"></video>
                    <div class="stats">${v.views} marta ko‚Äòrilgan</div>
                    <div class="likebar">
                        <button class="likebtn ${getLikeStatus(type,v.id)=='like'?'liked':''}" onclick="likeVideo('${type}',${v.id})">üëç ${v.likes}</button>
                        <button class="dislikebtn ${getLikeStatus(type,v.id)=='dislike'?'liked':''}" onclick="dislikeVideo('${type}',${v.id})">üëé ${v.dislikes}</button>
                    </div>
                  </div>
                `;
            });
            document.getElementById('content').innerHTML = html;
        }

        function likeVideo(type, id) {
            if(getLikeStatus(type,id)==='like') return;
            let v = videos[type].find(x=>x.id===id); v.likes++;
            setLikeStatus(type, id, 'like');
            showTab(type);
        }
        function dislikeVideo(type, id) {
            if(getLikeStatus(type,id)==='dislike') return;
            let v = videos[type].find(x=>x.id===id); v.dislikes++;
            setLikeStatus(type, id, 'dislike');
            showTab(type);
        }

        function renderUpload() {
            let html = `
                <form class="upldform" onsubmit="event.preventDefault();uploadVideo()">
                    <label>Video nomi:</label><br>
                    <input type="text" id="v_title" required><br>
                    <label>Video URL (mp4):</label><br>
                    <input type="url" id="v_url" required placeholder="https://...mp4"><br>
                    <label>Bo‚Äòlim:</label><br>
                    <select id="v_type">
                        <option value="cinema">Kino</option>
                        <option value="shorts">Shorts</option>
                    </select><br>
                    <button type="submit" class="upload-btn">Yuklash</button>
                </form>
            `;
            document.getElementById('content').innerHTML = html;
        }

        function uploadVideo() {
            let t = document.getElementById('v_title').value;
            let u = document.getElementById('v_url').value;
            let tp = document.getElementById('v_type').value;
            videos[tp].push({id: Date.now(), title:t, url:u, views:1, likes:0, dislikes:0});
            alert("‚úÖ Video yuklandi!");
            showTab(tp);
        }

        function renderTop() {
            let all = [...videos.cinema, ...videos.shorts].sort((a,b)=>b.views-a.views);
            let html = `<h2 style="text-align:center;">TOP ko‚Äòrilganlar</h2>`;
            all.slice(0,6).forEach(v=>{
                html += `
                  <div class="card">
                    <div class="card-title">${v.title}</div>
                    <video class="card-video" controls src="${v.url}"></video>
                    <div class="stats">${v.views} marta ko‚Äòrilgan</div>
                  </div>
                `;
            });
            document.getElementById('content').innerHTML = html;
        }

        showTab('cinema');
    </script>
</body>
</html>
